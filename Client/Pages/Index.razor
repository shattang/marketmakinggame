@page "/"
@implements IDisposable
@using Lib
@using MarketMakingGame.Shared.Messages
@inject NavigationManager NavigationManager
@inject AppService AppService

<div>
  <UserBadge />
  <div style="text-align: center; display: inline-block; width: 100%;">
    <MatHeadline4><img src="poker.png" width=32 height=32 /> The Market Making Game</MatHeadline4>
  </div>
</div>
<p></p>
<MatDivider />
<p></p>

@if (ViewType == ViewTypes.Create)
{
  <CreateGame />
  @* <BSJumbotron>
    <Console />
    </BSJumbotron> *@
}
else if (ViewType == ViewTypes.Join)
{
  <p>Joining Game @JoinGameId ...</p>
}
else
{
  <p>Loading ...</p>
}

@code {
  public enum ViewTypes
  {
    Default,
    Create,
    Join
  };

  public ViewTypes ViewType { get; set; } = ViewTypes.Default;

  public String JoinGameId { get; set; } = String.Empty;

  protected override async Task OnInitializedAsync()
  {
    await AppService.InitializeAsync();

    if (!AppService.UserDataEditorViewModel.CheckValid().Success)
    {
      AppService.UserDataEditorViewModel.IsUserDataEditorOpen = true;
    }

    if (NavigationManager.TryGetQueryString<String>("JoinGameId", out var joinGameId))
    {
      JoinGameId = joinGameId;
      ViewType = ViewTypes.Join;
    }
    else
    {
      ViewType = ViewTypes.Create;
    }
  }

  public void Dispose()
  { }

}